# Инструкция по установке и запуску YouTube Researcher

## Локальная установка

### 1. Подготовка окружения

#### Установка Python
Убедитесь, что у вас установлен Python версии 3.8 или выше. Скачать Python можно на [официальном сайте](https://www.python.org/downloads/).

#### Установка Chrome
Приложение использует Chrome для работы с YouTube. Убедитесь, что Chrome установлен в вашей системе.

### 2. Настройка проекта

#### Создание виртуального окружения
```bash
# В корне проекта выполните:
python -m venv virtual_environment

# Активация виртуального окружения:
# Windows:
virtual_environment\Scripts\activate

# Linux/Mac:
source virtual_environment/bin/activate
```

#### Установка зависимостей
```bash
pip install -r requirements.txt
```

### 3. Настройка секретов

Создайте файл `.streamlit/secrets.toml` со следующим содержимым:

```toml
# API ключи для доступа к LLM моделям
OPENAI_API_KEY = "your-openai-api-key"
ANTHROPIC_API_KEY = "your-anthropic-api-key"

# Список прокси-серверов для работы с YouTube
[proxies]
servers = [
  "ip:port:username:password",
  "ip:port:username:password",
  "ip:port:username:password"
]
```

Замените значения на ваши реальные API ключи и прокси-сервера.

### 4. Запуск приложения

```bash
streamlit run app.py
```

Приложение будет доступно по адресу: http://localhost:8501

## Решение проблем при локальной установке

### Проблема с модулем distutils
Если вы получаете ошибку `ModuleNotFoundError: No module named 'distutils'`, установите setuptools:

```bash
pip install setuptools
```

### Проблемы с Selenium и ChromeDriver
Если возникают проблемы с Selenium или ChromeDriver:

1. Убедитесь, что Chrome установлен в стандартном расположении
2. Попробуйте принудительно установить правильную версию ChromeDriver:
   ```bash
   pip uninstall webdriver-manager
   pip install webdriver-manager==3.8.6
   ```

### Проблемы с прокси
Если прокси не работают или вызывают ошибки, проверьте:
1. Формат данных прокси (ip:port:username:password)
2. Актуальность прокси (они могут устаревать)
3. Доступность прокси из вашей сети

## Развертывание на Streamlit Cloud

### 1. Подготовка GitHub репозитория

1. Создайте репозиторий на GitHub
2. Добавьте в него все файлы проекта
3. Убедитесь, что файл `.streamlit/secrets.toml` добавлен в `.gitignore` и не загружен на GitHub

### 2. Настройка Streamlit Cloud

1. Зарегистрируйтесь на [Streamlit Cloud](https://streamlit.io/cloud)
2. Создайте новое приложение, выбрав ваш GitHub репозиторий
3. Настройте секреты в разделе "Advanced settings" > "Secrets":
   ```toml
   OPENAI_API_KEY = "your-openai-api-key"
   ANTHROPIC_API_KEY = "your-anthropic-api-key"

   [proxies]
   servers = ["ip:port:username:password","ip:port:username:password"]
   ```
4. В настройках приложения укажите команду запуска: `streamlit run app.py`

### 3. Запуск и мониторинг

После настройки, Streamlit Cloud автоматически запустит ваше приложение.

Для мониторинга ошибок и производительности:
1. Перейдите в раздел "Logs" вашего приложения
2. Проверьте консоль разработчика в браузере (F12)

## Примечания безопасности

1. Никогда не храните приватные ключи API и данные прокси в публичном репозитории
2. Используйте виртуальное окружение для изоляции зависимостей
3. Регулярно обновляйте пароли к API и прокси-серверам
4. При размещении на Streamlit Cloud используйте секреты вместо хранения данных в коде

## Тестирование функционала получения рекомендаций

Для быстрой проверки работоспособности функционала получения рекомендаций добавлена специальная кнопка "Тестировать получение рекомендаций из списка исходных ссылок".

### Как использовать тестовый режим:

1. Введите список URL (ссылок) на YouTube видео или каналы в поле "Список исходных ссылок" (по одной ссылке на строку).
2. Нажмите кнопку "Тестировать получение рекомендаций из списка исходных ссылок", которая находится рядом с основной кнопкой "Найти лучшие ролики на YouTube".
3. Система запустит облегченный процесс сбора данных:
   - Для каждого канала: получит до 5 последних видео и до 5 рекомендаций для каждого видео
   - Для каждого видео: получит детали видео и до 5 рекомендаций
4. Результаты будут отображены в таблице с колонками:
   - Ссылка на видео
   - Заголовок видео
   - Дата публикации видео
   - Количество просмотров
   - Источник видео (откуда получено)

### Особенности тестового режима:

- Работает без использования прокси для максимальной скорости и стабильности
- Использует упрощенную логику без дополнительной фильтрации и анализа контента
- Предназначен только для проверки работоспособности основных функций получения рекомендаций
- Результаты можно скачать в CSV-файле для дальнейшего анализа

### Отладка работы с YouTube при помощи командной строки

Для проверки работоспособности основных функций YouTube Analyzer без использования веб-интерфейса можно использовать команду:

```
python check_proxies.py --test-youtube
```

Эта команда проверит инициализацию драйвера, получение видео с канала и получение рекомендаций без использования прокси.

### Рекомендации по устранению проблем:

1. **Драйвер не инициализируется:**
   - Убедитесь, что установлена последняя версия Chrome
   - Проверьте соответствие версии ChromeDriver и вашего браузера
   - Временно отключите антивирус или брандмауэр (они могут блокировать WebDriver)

2. **Не удается получить видео с канала:**
   - Проверьте корректность URL канала
   - Попробуйте другие популярные каналы для сравнения
   - Убедитесь, что доступ к YouTube не ограничен в вашей сети

3. **Не удается получить рекомендации:**
   - Убедитесь, что видео не удалено и доступно для просмотра
   - Проверьте скорость подключения к интернету
   - Попробуйте перезапустить браузер и драйвер

4. **Общие проблемы:**
   - Проверьте журнал ошибок (лог) для выявления конкретной проблемы
   - Обновите все зависимости до последних версий
   - При необходимости очистите кэш браузера и cookies
   
Этот тестовый функционал можно использовать как основу для более сложных сценариев анализа рекомендаций YouTube. 